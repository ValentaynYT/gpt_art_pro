<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–ü–∞–Ω–µ–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.2s ease;
            font-family: Arial, sans-serif;
        }

        body {
            background: rgb(39,40,43);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding-top: 120px;
        }

        .top-menu {
            display: flex;
            justify-content: center;
            gap: 20px;
            width: 100%;
            padding: 25px;
            background-color: rgb(22, 23, 39);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            position: fixed;
            top: 0;
            z-index: 1000;
        }

        .top-menu a {
            padding: 12px 25px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            border-radius: 50px;
            background: linear-gradient(0deg, rgba(93,113,245,1) 34%, rgba(76,81,255,1) 78%);
            color: white;
            text-decoration: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            position: relative;
        }

        .top-menu a:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(93, 113, 245, 0.4);
        }

        .dashboard-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 1200px;
            margin-bottom: 40px;
            gap: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }

        .welcome-section {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, rgba(93,113,245,0.2) 0%, rgba(0,255,136,0.1) 100%);
            border-radius: 12px;
            margin-bottom: 10px;
            width: 100%;
        }

        .welcome-section h1 {
            color: #00ff88;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .dashboard-section {
            width: 100%;
            padding: 25px;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }

        .dashboard-section h2 {
            margin-top: 0;
            color: #00ff88;
            font-size: 1.5em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dashboard-section p {
            font-size: 1.1em;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .dashboard-link {
            display: inline-block;
            margin-top: 15px;
            padding: 12px 25px;
            background: rgba(93, 113, 245, 0.3);
            border-radius: 8px;
            color: white;
            text-decoration: none;
            font-weight: bold;
            border: 1px solid rgba(93, 113, 245, 0.5);
        }

        .dashboard-link:hover {
            background: rgba(93, 113, 245, 0.6);
            transform: translateY(-2px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #5d71f5;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.8);
        }

        .quick-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .action-button {
            padding: 12px 20px;
            background: rgba(93, 113, 245, 0.3);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            border: 1px solid rgba(93, 113, 245, 0.5);
        }

        .action-button:hover {
            background: rgba(93, 113, 245, 0.6);
            transform: translateY(-2px);
        }

        .action-button.primary {
            background: rgba(0, 255, 136, 0.3);
            border: 1px solid rgba(0, 255, 136, 0.5);
        }

        .action-button.primary:hover {
            background: rgba(0, 255, 136, 0.6);
        }

        .requests-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .requests-table th, .requests-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .requests-table th {
            background: rgba(93, 113, 245, 0.3);
            font-weight: bold;
            text-transform: uppercase;
            font-size: 14px;
        }

        .requests-table tr:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            text-align: center;
            display: inline-block;
        }

        .status-new { background: rgba(93, 113, 245, 0.3); color: #5d71f5; }
        .status-approved { background: rgba(0, 255, 136, 0.3); color: #00ff88; }
        .status-rejected { background: rgba(255, 71, 87, 0.3); color: #ff4757; }

        .notification-badge {
            background: #ff4757;
            color: white;
            border-radius: 50%;
            padding: 3px 8px;
            font-size: 12px;
            margin-left: 8px;
            font-weight: bold;
            min-width: 20px;
            height: 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .profile-button {
            position: absolute;
            right: 50px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 12px;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: linear-gradient(0deg, rgba(93,113,245,1) 34%, rgba(76,81,255,1) 78%);
        }

        .profile-button:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(93, 113, 245, 0.4);
        }

        .profile-modal {
            display: none;
            position: absolute;
            right: 50px;
            top: 75px;
            background-color: white;
            color: black;
            width: 180px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }

        .profile-modal a {
            display: block;
            padding: 15px 20px;
            color: #333;
            text-decoration: none;
            text-align: left;
            font-size: 14px;
            border-bottom: 1px solid #f0f0f0;
        }

        .profile-modal a:hover {
            background-color: #f8f9fa;
            color: #5d71f5;
        }

        .profile-modal a:last-child {
            border-bottom: none;
        }

        @media (max-width: 768px) {
            body {
                padding-top: 140px;
            }

            .top-menu {
                flex-wrap: wrap;
                padding: 15px;
                gap: 10px;
            }

            .top-menu a {
                padding: 10px 15px;
                font-size: 14px;
                flex: 1;
                min-width: 120px;
                justify-content: center;
            }

            .profile-button {
                right: 20px;
                position: fixed;
                top: 15px;
            }

            .profile-modal {
                right: 20px;
                top: 70px;
            }

            .dashboard-container {
                padding: 20px;
                width: 95%;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .quick-actions {
                flex-direction: column;
            }

            .requests-table {
                font-size: 12px;
            }

            .requests-table th, .requests-table td {
                padding: 8px;
            }
        }

        @media (max-width: 480px) {
            .top-menu a {
                font-size: 12px;
                padding: 8px 12px;
            }

            .dashboard-section {
                padding: 15px;
            }

            .welcome-section h1 {
                font-size: 2em;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="top-menu">
        <a href="{{ url_for('owner_products') }}">–û–±—â–∏–π —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</a>
        <a href="{{ url_for('owner_requests') }}">
            –ó–∞—è–≤–∫–∏ –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–æ–≤
            {% if new_requests_count > 0 %}
                <span class="notification-badge">{{ new_requests_count }}</span>
            {% endif %}
        </a>
        <a href="{{ url_for('owner_dashboard') }}">–ì–ª–∞–≤–Ω–∞—è</a>
        <button class="profile-button" id="profile-button">üë§</button>
        <div class="profile-modal" id="profile-modal">
            <a href="{{ url_for('logout') }}" style="color: #ff4757;">–í—ã–π—Ç–∏</a>
        </div>
    </div>

    <div class="dashboard-container">
        <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
        <div class="welcome-section">
            <h1>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ Ô∏è</h1>
            <p id="current-date">–°–µ–≥–æ–¥–Ω—è: {{ current_date.strftime('%d.%m.%Y') if current_date else '–î–∞—Ç–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞' }}</p>
        </div>

        <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="dashboard-section">
            <h2>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number">{{ total_products }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">{{ new_requests_count }}</div>
                    <div class="stat-label">–ù–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">{{ approved_requests_count }}</div>
                    <div class="stat-label">–û–¥–æ–±—Ä–µ–Ω–æ –∑–∞—è–≤–æ–∫</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">{{ total_requests_count }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</div>
                </div>
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ -->
        <div class="dashboard-section">
            <h2>üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h2>
            <p>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ: <strong>{{ total_products }}</strong></p>
            <p>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: <strong>{{ last_deletion_time if last_deletion_time else '–ù–µ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å' }}</strong></p>

            <div class="quick-actions">
                <button class="action-button primary" onclick="window.location.href='{{ url_for('owner_products') }}'">
                    –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
                </button>
            </div>
        </div>

        <!-- –ó–∞—è–≤–∫–∏ –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–æ–≤ -->
        <div class="dashboard-section">
            <h2>üìã –ó–∞—è–≤–∫–∏ –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–æ–≤</h2>
            <p>–ù–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫, —Ç—Ä–µ–±—É—é—â–∏—Ö –≤–Ω–∏–º–∞–Ω–∏—è: <strong>{{ new_requests_count }}</strong></p>

            {% if recent_requests %}
            <div class="recent-requests">
                <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏:</h3>
                <table class="requests-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ó–∞–∫–∞–∑—á–∏–∫</th>
                            <th>–¢–∏–ø</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–∞—Ç–∞</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for request in recent_requests %}
                        <tr>
                            <td>#{{ request.id }}</td>
                            <td>{{ request.email }}</td>
                            <td>
                                {% if request.type == 'order' %}–ó–∞–∫–∞–∑
                                {% elif request.type == 'return' %}–í–æ–∑–≤—Ä–∞—Ç
                                {% elif request.type == 'issue' %}–ü—Ä–æ–±–ª–µ–º–∞
                                {% else %}–î—Ä—É–≥–æ–µ{% endif %}
                            </td>
                            <td>
                                <span class="status-badge
                                    {% if request.status == 'new' or request.status == '–ù–æ–≤–∞—è' %}status-new
                                    {% elif request.status == 'approved' or request.status == '–û–¥–æ–±—Ä–µ–Ω–∞' %}status-approved
                                    {% elif request.status == 'rejected' or request.status == '–û—Ç–∫–ª–æ–Ω–µ–Ω–∞' %}status-rejected
                                    {% endif %}">
                                    {% if request.status == 'new' or request.status == '–ù–æ–≤–∞—è' %}–ù–æ–≤–∞—è
                                    {% elif request.status == 'approved' or request.status == '–û–¥–æ–±—Ä–µ–Ω–∞' %}–û–¥–æ–±—Ä–µ–Ω–∞
                                    {% elif request.status == 'rejected' or request.status == '–û—Ç–∫–ª–æ–Ω–µ–Ω–∞' %}–û—Ç–∫–ª–æ–Ω–µ–Ω–∞
                                    {% else %}{{ request.status }}{% endif %}
                                </span>
                            </td>
                            <td>{{ request.created_at.strftime('%d.%m.%Y %H:%M') if request.created_at else '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% endif %}

            <div class="quick-actions">
                <button class="action-button primary" onclick="window.location.href='{{ url_for('owner_requests') }}'">
                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏
                </button>
            </div>
        </div>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="dashboard-section">
            <h2>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            <div class="quick-actions">
                <button class="action-button" onclick="window.location.href='{{ url_for('owner_products') }}'">
                    üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
                </button>
                <button class="action-button" onclick="window.location.href='{{ url_for('owner_requests') }}'">
                    üìã –ó–∞—è–≤–∫–∏ –∑–∞–∫–∞–∑—á–∏–∫–æ–≤
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º –ø—Ä–æ—Ñ–∏–ª—è
            const profileButton = document.getElementById('profile-button');
            const profileModal = document.getElementById('profile-modal');

            profileButton.addEventListener('click', function(event) {
                event.stopPropagation();
                profileModal.style.display = profileModal.style.display === 'block' ? 'none' : 'block';
            });

            document.addEventListener('click', function(event) {
                if (!profileButton.contains(event.target) && !profileModal.contains(event.target)) {
                    profileModal.style.display = 'none';
                }
            });

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
            updateCurrentDate();
        });

        function updateCurrentDate() {
            const now = new Date();
            const options = {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            };
            const dateElement = document.getElementById('current-date');
            if (dateElement && dateElement.textContent.includes('–î–∞—Ç–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞')) {
                dateElement.textContent = '–°–µ–≥–æ–¥–Ω—è: ' + now.toLocaleDateString('ru-RU', options);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        setInterval(updateCurrentDate, 60000);
    </script>
</body>
</html>